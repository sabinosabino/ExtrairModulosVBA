Attribute VB_Name = "ExtratorModulos"
Private Vbcoms As VBIDE.VBComponents
Private Vbcom As VBIDE.VBComponent
Private Sub Extrair()
On Error GoTo 1
Set Vbcoms = Application.VBE.ActiveVBProject.VBComponents
If VerificaPastaExiste Then
    For Each Vbcom In Vbcoms
        Vbcom.Export CurrentProject.Path & "\modules\" & Vbcom.Name
    Next
End If
Exit Sub
1:
MsgBox Err.Description, vbCritical, "Atenção"
End Sub
Private Function VerificaPastaExiste() As Boolean
Dim fso As Object
Dim caminho As String
caminho = CurrentProject.Path & "\modules"
Set fso = CreateObject("Scripting.FileSystemObject")
If fso.FolderExists(caminho) Then
    Call fso.DeleteFolder(caminho)
    Call fso.createfolder(caminho)
    VerificaPastaExiste = True
Else
    Call fso.createfolder(caminho)
    VerificaPastaExiste = True
End If

End Function

Public Sub ExecultarExtracao()
Call Extrair
End Sub
